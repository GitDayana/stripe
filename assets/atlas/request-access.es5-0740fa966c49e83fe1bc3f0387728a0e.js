(function(){"use strict";var e=document.getElementById("overlay");e.style.display="none";var t=function(n){e.removeAttribute("style"),e.offsetTop,document.documentElement.classList.add("no-scroll"),e.className="active",u.className="modal-in",document.querySelector("#full-name").focus(),n&&n.preventDefault()},n=function(n){document.documentElement.classList.remove("no-scroll"),e.removeAttribute("class"),u.removeAttribute("class"),setTimeout(function(){e.style.display="none"},800),n&&n.preventDefault()},r=["#main-content header","#end-actions"].map(function(e){return e+" .request-access .main-action"});r.push("[href='#request-access']"),r.forEach(function(e){return document.querySelector(e).addEventListener("click",t)});var i=e.querySelector(".close");i.addEventListener("click",n),window.addEventListener("keydown",function(t){e.classList.contains("active")&&t.keyCode==27&&n()});var s=Array.prototype.slice.call(e.querySelectorAll("#modal label + *"));s.forEach(function(e){var t=e.parentNode;e.value&&e.tagName.toLowerCase()==="input"&&t.classList.add("done"),t.addEventListener("click",function(){e.focus()}),e.addEventListener("focus",function(){t.classList.add("done")}),e.addEventListener("blur",function(){if(e.value)return;t.classList.remove("done")})});var o=document.getElementById("thanks"),u=document.getElementById("modal"),a=u.querySelector("form");u.addEventListener("animationend",function(){u.className="animation-end"}),a.addEventListener("submit",function(e){e.preventDefault();var t=!0;s.forEach(function(e){e.validity.valid?e.parentNode.classList.remove("invalid"):(t=!1,e.parentNode.classList.add("invalid"))});var r=document.querySelector(".field.country");r.classList.contains("done")?r.classList.remove("invalid"):(t=!1,r.classList.add("invalid"));if(!t){u.className="error-shake";return}$.ajax({url:"/atlas",type:"POST",data:$(a).serialize(),dataType:"json",success:function(){o.classList.add("active"),setTimeout(n,2e3)},error:function(){console.log(arguments)}})}),location.hash=="#request-access"&&setTimeout(t,2200)})();