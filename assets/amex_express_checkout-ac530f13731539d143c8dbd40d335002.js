$(function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,t,n;typeof document.hidden!="undefined"?(t="hidden",n="visibilitychange"):typeof document.mozHidden!="undefined"?(t="mozHidden",n="mozvisibilitychange"):typeof document.msHidden!="undefined"?(t="msHidden",n="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(t="webkitHidden",n="webkitvisibilitychange");var r=function(){var e=document.createElement("div");e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->";var t=e.getElementsByTagName("i").length==1;return!t},i=$("section.hero"),s=i.width();$(window).on("resize",function(){s=i.width()});var o=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},u=new Image;u.src="/img/amex_express_checkout/logo"+(window.devicePixelRatio>1?"@2x":"")+".png",u.addEventListener("load",function(){setTimeout(function(){$("body").addClass("loaded")},500)});var a=function(e){this.color=o(1,3),this.translateZ=[-300,0,300][this.color-1],this.initialMetrics={top:o(0,80),rotateX:o(22,67),rotateY:o(180,360)},this.finalMetrics={rotateX:o(45,135),rotateY:o(360,720)},this.translateX=e?o(-300,s+300):-300,this.$el=$("<div class='card color"+this.color+"'></div>"),this.$el.css({top:this.initialMetrics.top+"%"}),this.applyTransform({translateX:this.translateX,rotateX:this.initialMetrics.rotateX,rotateY:this.initialMetrics.rotateY})};a.prototype={addToContainer:function(e){e.append(this.$el),window.getComputedStyle(this.$el[0]).getPropertyValue("transform"),this.animationTick()},applyTransform:function(e){var t="translateX("+e.translateX+"px) translateZ("+this.translateZ+"px) rotateX("+e.rotateX+"deg) rotateY("+e.rotateY+"deg)";this.$el.css({transform:t,"-webkit-transform":t,"-moz-transform":t})},animationTick:function(){this.translateX+=.5;if(this.translateX<s+300){var t=this.translateX/(s+300),n=(this.finalMetrics.rotateX-this.initialMetrics.rotateX)*t+this.initialMetrics.rotateX,r=(this.finalMetrics.rotateY-this.initialMetrics.rotateY)*t+this.initialMetrics.rotateY;this.applyTransform({translateX:this.translateX,rotateX:n,rotateY:r}),e(this.animationTick.bind(this))}else this.$el.remove()}};var f,l=function(){f==null&&(f=setInterval(function(){var e=new a;e.addToContainer(i)},1500))},c=function(){clearInterval(f),f=null},h=function(){document[t]?c():l()};if(r()){for(var p=0;p<30;p++){var d=new a(!0);d.addToContainer(i)}document[t]||l(),document.addEventListener(n,h,!1)}});